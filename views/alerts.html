{% extends 'base/layout.html' %}

{% block config %}
    {% include 'config/filter.html' %}
{% endblock %}

{% block content %}
    
    <div id="page-content">
        <br/>
        {% include "search.html" %}
        <div class="row" id="vue-page">
            <div class="col-md-12">
                <div class="panel">
                    <div class="panel-body">
                        <div class="table-responsive graph">
                            <table class="table table-striped" id="table-alerts">
                                <thead>
                                    <tr>
                                        <th>Time</th>
                                        <th>SRC IP</th>
                                        <th>DST IP</th>
                                        <th>PORT</th>
                                        <th>NET BYTES</th>
                                        <th>TTL</th>
                                        <th>Country</th>
                                        <th>City</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="alert in alerts">
                                        <td v-html="format_date(alert.timestamp)"></td>
                                        <td v-html="format_ip('net_src_ip', alert)"></td>
                                        <td v-html="format_ip('net_dst_ip', alert)"></td>
                                        <td>${alert.net_dst_port}</td>
                                        <td>${alert.net_bytes_total}</td>
                                        <td>${alert.net_ttl}</td>
                                        <td>
                                            <img :src="src_flag(alert.iso_code)"/>&nbsp;&nbsp;
                                            ${alert.country}
                                        </td>
                                        <td><span v-if="alert.city">${alert.city}</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>    
    </div>

{% endblock %}

{% block css_include %}

{% endblock %}

{% block js_include %}  
    <script src="/static/js/alerts.js"></script>
{% endblock %}

{% block jquery_code %}

{% endblock %}


